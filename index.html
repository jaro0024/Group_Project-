<head>

  <meta charset="utf-8">

  <title>Top Shelf Crusaders</title>

  <!--Bootstrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <!--Font Awesome-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <!--Google Fonts-->
  <link href="https://fonts.googleapis.com/css?family=Redressed" rel="stylesheet">

  <!--CSS-->
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">

  <!--Firebase reference-->
  <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>


</head>

<body>



<!--Motion Background-->
	<video autoplay muted>

		<source src="assets/images/background.webm" type="video/webm">

		<source src="assets/images/background.mp4" type="video/mp4">

		<source src="assets/images/background.ogv" type="video/ogv">

	</video>


	<!--Nav Bar-->

		<nav class="navbar navbar-expand-xl navbar-light .text-muted">

  		<!--Logo-->
  			<h2>Top Shelf <i class="fa fa-cutlery" aria-hidden="true"></i> Crusaders</h2>

 		<!--Responsive Dropdown Menu-->
 			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">

   			<span class="navbar-toggler-icon"></span>

 			</button>



	<div class="collapse navbar-collapse" id="navbarText">

    		<ul class="navbar-nav ml-auto">

        	  <!--Twitter Link-->
      			<li class="nav-item active">

        			<a class="nav-link" href="">

        				<span class="fa-stack fa-lg">

  						<i class="fa fa-square-o fa-stack-2x"></i>

  						<i class="fa fa-twitter fa-stack-1x"></i>

						</span>

					</a>

      			</li>

      		   <!--Favorite Link-->
      			<li class="nav-item">

        			<a class="nav-link" href="">

        				<span class="fa-stack fa-lg">

						<i class="fa fa-square-o fa-stack-2x"></i>

						<i class="fa fa-heart fa-stack-1x" aria-hidden="true"></i>

						</span>

					</a>

      			</li>


    		</ul>
   </div>


</nav>

<!--Main-screen-->
<div class="container" id="main-screen">

  	<div class="row">

		<div class="col-md-12" id="quote">

			<p><em>"You don’t need a silver fork to eat good food.”</em><br>

			<strong>  -Paul Prudhomme</strong></p>

		</div>

	</div>

	<div class="row">

  		<div class="col-md-12" id="ingred-search">

  			<input class="form-control form-control-lg" type="text" placeholder="Ingredient Search" id="ingr-input"> <br>

  			<button type="button" class="btn btn-success" id="findIngr">Find my recipe</button>

  		</div>



  	</div>

</div>

<!--Container to hold recipe search results-->
<div class="container" id="search-results">


</div>




<!--Container to hold selected recipe-->
<div class="container" id="content">

  	<div class="row">

  		<div class="col-md-6">

  				<h5>Recipe Image</h5>

  			<img src="https://media.istockphoto.com/photos/female-hand-cut-tomatoes-rustic-kitchen-tablevegetarian-concept-picture-id502320166?k=6&m=502320166&s=612x612&w=0&h=GMNnaPDdq1kWNrvqT9PAoES1jrc0Ki0m4tjCIRH1kRo=" alt="..." class="img-thumbnail">

  			</div>

  		<div class="col-md-6" id="recipe">

  			<div class="card">

  				<div class="card-body">

  	    				<ol>

  	    					<h5>Baked Dijon Salmon</h5><br>

  	    					<li>Preheat oven to 400 degrees F (200 degrees C).</li><br>

  	    					<li>In a small bowl, stir together butter, mustard, and honey. Set aside. In another bowl, mix together bread crumbs, pecans, and parsley.</li><br>

  							<li>Brush each salmon fillet lightly with honey mustard mixture, and sprinkle the tops of the fillets with the bread crumb mixture.</li><br>

  							<li>Bake salmon 12 to 15 minutes in the preheated oven, or until it flakes easily with a fork. Season with salt and pepper, and garnish with a wedge of lemon.</li><br>

  					</ol>

  				</div>

  				</div>

  			</div>
  		</div>
</div>











<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


    	//On page load the content container should be hidden
    	$(document).ready(function() {
    		$("#search-results").hide();

    		$("#content").hide();
        $("#recipe").hide();
          })

    		//User inputs ingreds. content appears
    		$("#findIngr").click(function() {
    			//console.log("i was clicked");
    			$("#ingred-search").animate({bottom: "30px"});
    			$("#quote").hide();

				$("#search-results").show();
				//User selects recipe
				$(".card.results").click(function() {

					console.log("I was clicked!");
					//Hide list of recipes
					$("#search-results").hide();

					//Show recipe selected and image
					$("#content").show();
});
})
           // This .on("click") function will trigger the AJAX Call
      $("#findIngr").on("click", function(event) {
        var recipe = $(this).attr("data-recipe");//
        // event.preventDefault() can be used to prevent an event's default behavior.
        // Here, it prevents the submit button from trying to submit a form when clicked
        event.preventDefault();
        // Here we grab the text from the input box
        var ingredient = $("#ingr-input").val().trim();

        var appId = "35f72116"

        var appKey = "f3dd5c58e168b6d60a6211c640e65b11"
        // Here we construct our URL
        var queryURL = "https://api.edamam.com/search?q=" + ingredient + "&app_id=" + appId + "&app_key=" + appKey + "&from=0&to=5";

        $.ajax ({
          url: queryURL,
          method: "GET"
        }).done(function(response) {
          for(var x = 0; x < response.hits.length; x++) {
              console.log(response);


              // Retrieves the recipe image
        var recipe_img = response.hits[x].recipe.image;
              console.log(recipe_img);
              //Retrieve recipe title
        var recipe_title =  response.hits[x].recipe.label;
              console.log(recipe_title);
              var recipe_instr = response.hits[x].recipe.url;
              console.log(recipe_instr);
              //Placing results in DOM

            // Creates a div to hold the recipe
              var newdiv = $('<div class="card-deck">'+
                                '<div class="card results" >'+
                                '<img class="card-img-top" src=' + recipe_img+' alt="Card image cap">' +'<div class="card-body">' + '<h5 class="card-title">'+recipe_title+'</h5>'+'</div>' + '</div>' + '</div>' + '</div>' );


          // Puts the entire Movie above the previous movies.
              $("#search-results").append(newdiv);



            }
        })
    });

    var config = {
      apiKey: "AIzaSyC8tE8l_DBoyPfFaiRc5fYfZ6jBK9XrcSs",
      authDomain: "groupproject-1b84f.firebaseapp.com",
      databaseURL: "https://groupproject-1b84f.firebaseio.com",
      projectId: "groupproject-1b84f",
      storageBucket: "",
      messagingSenderId: "208222818748"
    };
    firebase.initializeApp(config);

    var database = firebase.database();

    // Capture Button Click
    $("#fa fa-heart fa-stack-1x").on("click", function(event) {
      event.preventDefault();
      var recipe_img = response.hits[x].recipe.image;
            console.log(recipe_img);
            //Retrieve recipe title
      var recipe_title =  response.hits[x].recipe.label;
            console.log(recipe_title);
            var recipe_instr = response.hits[x].recipe.url;
            console.log(recipe_instr);
      var favorites = {
        image: recipe_img,
        recipe: recipe_title,
      };
      // Code for handling the push
      database.ref().push(favorites
      );
      console.log(favorites.image);
      console.log(favorites.recipe);

    });

    database.ref().on("child_added", function(childSnapshot, prevChildKey) {

      console.log(childSnapshot.val());

      var favImage = childSnapshot.val().image;
      var favRecipe = childSnapshot.val().recipe;

      console.log(favImage);
      console.log(favRecipe);


      $("#favoritesDiv").append(favImage);
      $("#favoritesDiv").append(favRecipe);
    });


    </script>
    



</body>

</html>
