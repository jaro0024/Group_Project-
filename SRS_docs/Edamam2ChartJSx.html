<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>In Search of Edamam Response</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <script src="Chart.bundle.min.js"></script>
</head>

<body>
  <div class="container">
    <h1>Edamam API Query to Chart.JS Testing</h1>

    <!-- We'll be dumping our JSON contents in here -->
    <div id="foodDiv"></div>

    <!-- This form will be where users input data about the movies -->
    <form id="searchForm">
      <label for="ingr-input">search</label>
      <input type="text" id="ingr-input"><br>

      <!-- This button will trigger our AJAX call -->
      <input id="findIngr" type="submit" value="ingredient search">
    </form>

    <canvas id="nutrChart" width="90%" height="30%">
    </canvas>

    <!-- <div id="dynamicChart"></div> -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      // This .on("click") function will trigger the AJAX Call
      $("#findIngr").on("click", function(event) {

        // event.preventDefault() can be used to prevent an event's default behavior.
        // Here, it prevents the submit button from trying to submit a form when clicked
        event.preventDefault();

        // Here we grab the text from the input box
        var ingredient = $("#ingr-input").val().trim();
        


        var appId = "015a1dc7"

        // "36c66d3a"
        
        var appKey = "16bab94aee14b5881f28798e788c26e0"

        // "8be8dd8b6a6f98a5221770fcb1d2f043"

        // Here we construct our URL
        var queryURL = "https://api.edamam.com/search?q=" + ingredient + "&app_id=" + appId + "&app_key=" + appKey + "&from=0&to=1";

        // https://api.edamam.com/search?app_id=yourappid&app_key=yourappkey&q=butter&diet=low-carb&diet=high-protein

        $.ajax({
          // xhrFields: {cors: false},
          url: queryURL,
          method: "GET"
        }).done(function(response) {
          console.log(response);

          var x = (JSON.stringify(response));

          var y = response;

          localStorage.setItem('ourData', JSON.stringify(response));

          // $("#foodDiv").append(x);

          // var rating = x.Rated;

          // // Creating an element to have the rating displayed
          // var pOne = $("<p>").text("Rating: " + rating);

          // Displaying the rating
          // foodDiv.append(response);

          // // Storing the release year
          // var released = response.Released;

          // // Creating an element to hold the release year
          // var pTwo = $("<p>").text("Released: " + released);

          // // Displaying the release year
          // foodDiv.append(pTwo);

          // // Storing the plot
          // var plot = response.Plot;

          // // Creating an element to hold the plot
          // var pThree = $("<p>").text("Plot: " + plot);

          // // Appending the plot
          // foodDiv.append(pThree);
        })

      });

      var ctx = $("#nutrChart");
      var nutrChart = new Chart(ctx, {
          type: 'bar',
          data: {
              labels: ["Nutr1", "Nutr2", "Nutr3", "Nutr4", "Nutr5", "Nutr6"],
              datasets: [{
                  label: 'nutrient content / USDA RDA %',
                  data: [18, 31, 6, 11, 25, 2],
                  backgroundColor: [
                      'rgba(255, 99, 132, 0.2)',
                      'rgba(54, 162, 235, 0.2)',
                      'rgba(255, 206, 86, 0.2)',
                      'rgba(75, 192, 192, 0.2)',
                      'rgba(153, 102, 255, 0.2)',
                      'rgba(255, 159, 64, 0.2)'
                  ],
                  borderColor: [
                      'rgba(255,99,132,1)',
                      'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(75, 192, 192, 1)',
                      'rgba(153, 102, 255, 1)',
                      'rgba(255, 159, 64, 1)'
                  ],
                  borderWidth: 1
              }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero:true
                      }
                  }]
              }
          }
      });
    </script>
  </div>
</body>

</html>